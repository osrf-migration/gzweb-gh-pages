{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/gzweb.json"}, "html": {"href": "#!/osrf/gzweb"}, "avatar": {"href": "data/bytebucket.org/ravatar/{3e2fc3f2-dc25-453b-9792-943c743d9b40}ts=1609263"}}, "type": "repository", "name": "gzweb", "full_name": "osrf/gzweb", "uuid": "{3e2fc3f2-dc25-453b-9792-943c743d9b40}"}, "links": {"attachments": {"href": "data/repositories/osrf/gzweb/issues/51/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/gzweb/issues/51.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gzweb/issues/51/watch"}, "comments": {"href": "data/repositories/osrf/gzweb/issues/51/comments_page=1.json"}, "html": {"href": "#!/osrf/gzweb/issues/51/directional-light-intensity-inconsistency"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gzweb/issues/51/vote"}}, "reporter": {"display_name": "Luc Guyot", "uuid": "{10bf39a6-3a1b-4c7f-9702-fe864c3e8066}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B10bf39a6-3a1b-4c7f-9702-fe864c3e8066%7D"}, "html": {"href": "https://bitbucket.org/%7B10bf39a6-3a1b-4c7f-9702-fe864c3e8066%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:baecfd3c-7ba6-47b5-8711-417af281b471/ed635f95-3d51-407b-b3c0-b20f3d58328a/128"}}, "nickname": "luc_guyot_", "type": "user", "account_id": "557058:baecfd3c-7ba6-47b5-8711-417af281b471"}, "title": "Directional light intensity inconsistency", "component": null, "votes": 0, "watches": 3, "content": {"raw": "Because THREE.js light intensity changes on the client side are translated into attenuation constant changes on the server side, the intensity of directional lights (for which attenuation is meaningless) never change on server side.\r\n\r\nTaken from gziface.js:\r\n\r\n```\r\n      var attenuation_constant = entity.children[0].intensity;\r\n      // Adjust according to factor\r\n      if (entity instanceof THREE.PointLight)\r\n      {\r\n        attenuation_constant *= 1.5;\r\n      }\r\n      else if (entity instanceof THREE.SpotLight)\r\n      {\r\n        attenuation_constant *= 5;\r\n      }\r\n\r\n      entityMsg.attenuation_constant = attenuation_constant;\r\n      entityMsg.attenuation_linear = entity.serverProperties.attenuation_linear;\r\n      entityMsg.attenuation_quadratic = entity.serverProperties.attenuation_quadratic;\r\n\r\n      that.lightModifyTopic.publish(entityMsg);\r\n```\r\n\r\n\r\nFix idea: store initial diffuse colors of directional lights and use THREE.js light intensity as a scalar that multiply every diffuse color component.\r\n", "markup": "markdown", "html": "<p>Because THREE.js light intensity changes on the client side are translated into attenuation constant changes on the server side, the intensity of directional lights (for which attenuation is meaningless) never change on server side.</p>\n<p>Taken from gziface.js:</p>\n<div class=\"codehilite\"><pre><span></span>      var attenuation_constant = entity.children[0].intensity;\n      // Adjust according to factor\n      if (entity instanceof THREE.PointLight)\n      {\n        attenuation_constant *= 1.5;\n      }\n      else if (entity instanceof THREE.SpotLight)\n      {\n        attenuation_constant *= 5;\n      }\n\n      entityMsg.attenuation_constant = attenuation_constant;\n      entityMsg.attenuation_linear = entity.serverProperties.attenuation_linear;\n      entityMsg.attenuation_quadratic = entity.serverProperties.attenuation_quadratic;\n\n      that.lightModifyTopic.publish(entityMsg);\n</pre></div>\n\n\n<p>Fix idea: store initial diffuse colors of directional lights and use THREE.js light intensity as a scalar that multiply every diffuse color component.</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": null, "edited_on": null, "created_on": "2014-12-10T15:58:57.926252+00:00", "milestone": null, "updated_on": "2014-12-11T09:08:51.362488+00:00", "type": "issue", "id": 51}