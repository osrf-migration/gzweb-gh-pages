{"links": {"self": {"href": "data/repositories/osrf/gzweb/pullrequests/114/comments/48376731.json"}, "html": {"href": "#!/osrf/gzweb/pull-requests/114/_/diff#comment-48376731"}}, "parent": {"id": 48376151, "links": {"self": {"href": "data/repositories/osrf/gzweb/pullrequests/114/comments/48376151.json"}, "html": {"href": "#!/osrf/gzweb/pull-requests/114/_/diff#comment-48376151"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 114, "links": {"self": {"href": "data/repositories/osrf/gzweb/pullrequests/114.json"}, "html": {"href": "#!/osrf/gzweb/pull-requests/114"}}, "title": "Test gzGui"}, "content": {"raw": "Right they are only constructed at the beginning of each test,\n\nBut the problem was that the objects are still there even after the test ends.\n\nfor example \n\n```\ndiff -r 9e37dafaff16 -r 88a35d757cb1 gz3d/build/gz3d.js\n--- a/gz3d/build/gz3d.js\tWed Oct 18 21:31:04 2017 +0800\n+++ b/gz3d/build/gz3d.js\tFri Oct 27 09:06:33 2017 +0800\n@@ -1095,8 +1095,8 @@\n \n   guiEvents.on('openTreeWhenSelected', function ()\n       {\n-        this.openTreeWhenSelected = !this.openTreeWhenSelected;\n-        if(!this.openTreeWhenSelected)\n+        that.openTreeWhenSelected = !that.openTreeWhenSelected;\n+        if(!that.openTreeWhenSelected)\n         {\n           $('#open-tree-when-selected').buttonMarkup({icon: 'false'});\n         }\n@@ -1109,8 +1109,8 @@\n \n   guiEvents.on('toggle_notifications', function ()\n       {\n-        this.showNotifications = !this.showNotifications;\n-        if(!this.showNotifications)\n+        that.showNotifications = !that.showNotifications;\n+        if(!that.showNotifications)\n         {\n           $('#toggle-notifications').buttonMarkup({icon: 'false'});\n         }\ndiff -r 9e37dafaff16 -r 88a35d757cb1 gz3d/src/gzgui.js\n--- a/gz3d/src/gzgui.js\tWed Oct 18 21:31:04 2017 +0800\n+++ b/gz3d/src/gzgui.js\tFri Oct 27 09:06:33 2017 +0800\n@@ -1090,8 +1090,8 @@\n \n   guiEvents.on('openTreeWhenSelected', function ()\n       {\n-        this.openTreeWhenSelected = !this.openTreeWhenSelected;\n-        if(!this.openTreeWhenSelected)\n+        that.openTreeWhenSelected = !that.openTreeWhenSelected;\n+        if(!that.openTreeWhenSelected)\n         {\n           $('#open-tree-when-selected').buttonMarkup({icon: 'false'});\n         }\n@@ -1104,8 +1104,8 @@\n \n   guiEvents.on('toggle_notifications', function ()\n       {\n-        this.showNotifications = !this.showNotifications;\n-        if(!this.showNotifications)\n+        that.showNotifications = !that.showNotifications;\n+        if(!that.showNotifications)\n         {\n           $('#toggle-notifications').buttonMarkup({icon: 'false'});\n         }\ndiff -r 9e37dafaff16 -r 88a35d757cb1 gz3d/test/gzgui_test.js\n--- a/gz3d/test/gzgui_test.js\tWed Oct 18 21:31:04 2017 +0800\n+++ b/gz3d/test/gzgui_test.js\tFri Oct 27 09:06:33 2017 +0800\n@@ -54,11 +54,12 @@\n \n           expect(gui.showNotifications).toEqual(false);\n           guiEvents.emit('toggle_notifications');\n-          expect(gui.showNotifications).toEqual(false);\n+          expect(gui.showNotifications).toEqual(true);\n \n-          // TODO: test set_view_as after finishing model spawning test.\n+          expect(gui.openTreeWhenSelected).toEqual(false);\n+          guiEvents.emit('openTreeWhenSelected');\n+          expect(gui.openTreeWhenSelected).toEqual(true)\n \n-          // TODO: test delete_entity after finishing model spawning test.\n         });\n       });\n```\nSo adding a `guiEvents.emit('toggle_notifications');` results in two additional  `console.log('Notification Toggle');`.\n", "markup": "markdown", "html": "<p>Right they are only constructed at the beginning of each test,</p>\n<p>But the problem was that the objects are still there even after the test ends.</p>\n<p>for example </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 9e37dafaff16 -r 88a35d757cb1 gz3d/build/gz3d.js</span>\n<span class=\"gd\">--- a/gz3d/build/gz3d.js    Wed Oct 18 21:31:04 2017 +0800</span>\n<span class=\"gi\">+++ b/gz3d/build/gz3d.js    Fri Oct 27 09:06:33 2017 +0800</span>\n<span class=\"gu\">@@ -1095,8 +1095,8 @@</span>\n\n   guiEvents.on(&#39;openTreeWhenSelected&#39;, function ()\n       {\n<span class=\"gd\">-        this.openTreeWhenSelected = !this.openTreeWhenSelected;</span>\n<span class=\"gd\">-        if(!this.openTreeWhenSelected)</span>\n<span class=\"gi\">+        that.openTreeWhenSelected = !that.openTreeWhenSelected;</span>\n<span class=\"gi\">+        if(!that.openTreeWhenSelected)</span>\n         {\n           $(&#39;#open-tree-when-selected&#39;).buttonMarkup({icon: &#39;false&#39;});\n         }\n<span class=\"gu\">@@ -1109,8 +1109,8 @@</span>\n\n   guiEvents.on(&#39;toggle_notifications&#39;, function ()\n       {\n<span class=\"gd\">-        this.showNotifications = !this.showNotifications;</span>\n<span class=\"gd\">-        if(!this.showNotifications)</span>\n<span class=\"gi\">+        that.showNotifications = !that.showNotifications;</span>\n<span class=\"gi\">+        if(!that.showNotifications)</span>\n         {\n           $(&#39;#toggle-notifications&#39;).buttonMarkup({icon: &#39;false&#39;});\n         }\n<span class=\"gh\">diff -r 9e37dafaff16 -r 88a35d757cb1 gz3d/src/gzgui.js</span>\n<span class=\"gd\">--- a/gz3d/src/gzgui.js Wed Oct 18 21:31:04 2017 +0800</span>\n<span class=\"gi\">+++ b/gz3d/src/gzgui.js Fri Oct 27 09:06:33 2017 +0800</span>\n<span class=\"gu\">@@ -1090,8 +1090,8 @@</span>\n\n   guiEvents.on(&#39;openTreeWhenSelected&#39;, function ()\n       {\n<span class=\"gd\">-        this.openTreeWhenSelected = !this.openTreeWhenSelected;</span>\n<span class=\"gd\">-        if(!this.openTreeWhenSelected)</span>\n<span class=\"gi\">+        that.openTreeWhenSelected = !that.openTreeWhenSelected;</span>\n<span class=\"gi\">+        if(!that.openTreeWhenSelected)</span>\n         {\n           $(&#39;#open-tree-when-selected&#39;).buttonMarkup({icon: &#39;false&#39;});\n         }\n<span class=\"gu\">@@ -1104,8 +1104,8 @@</span>\n\n   guiEvents.on(&#39;toggle_notifications&#39;, function ()\n       {\n<span class=\"gd\">-        this.showNotifications = !this.showNotifications;</span>\n<span class=\"gd\">-        if(!this.showNotifications)</span>\n<span class=\"gi\">+        that.showNotifications = !that.showNotifications;</span>\n<span class=\"gi\">+        if(!that.showNotifications)</span>\n         {\n           $(&#39;#toggle-notifications&#39;).buttonMarkup({icon: &#39;false&#39;});\n         }\n<span class=\"gh\">diff -r 9e37dafaff16 -r 88a35d757cb1 gz3d/test/gzgui_test.js</span>\n<span class=\"gd\">--- a/gz3d/test/gzgui_test.js   Wed Oct 18 21:31:04 2017 +0800</span>\n<span class=\"gi\">+++ b/gz3d/test/gzgui_test.js   Fri Oct 27 09:06:33 2017 +0800</span>\n<span class=\"gu\">@@ -54,11 +54,12 @@</span>\n\n           expect(gui.showNotifications).toEqual(false);\n           guiEvents.emit(&#39;toggle_notifications&#39;);\n<span class=\"gd\">-          expect(gui.showNotifications).toEqual(false);</span>\n<span class=\"gi\">+          expect(gui.showNotifications).toEqual(true);</span>\n\n<span class=\"gd\">-          // TODO: test set_view_as after finishing model spawning test.</span>\n<span class=\"gi\">+          expect(gui.openTreeWhenSelected).toEqual(false);</span>\n<span class=\"gi\">+          guiEvents.emit(&#39;openTreeWhenSelected&#39;);</span>\n<span class=\"gi\">+          expect(gui.openTreeWhenSelected).toEqual(true)</span>\n\n<span class=\"gd\">-          // TODO: test delete_entity after finishing model spawning test.</span>\n         });\n       });\n</pre></div>\n\n\n<p>So adding a <code>guiEvents.emit('toggle_notifications');</code> results in two additional  <code>console.log('Notification Toggle');</code>.</p>", "type": "rendered"}, "created_on": "2017-10-31T01:04:45.078841+00:00", "user": {"display_name": "Mohamd Ayman", "uuid": "{72e87935-5983-4f36-8505-0c88a6493930}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B72e87935-5983-4f36-8505-0c88a6493930%7D"}, "html": {"href": "https://bitbucket.org/%7B72e87935-5983-4f36-8505-0c88a6493930%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:53a1879d-b572-46c9-97d3-8fa52b2ff8a7/d5d765e0-f86b-4c0d-93ed-c67429f1f465/128"}}, "nickname": "Mohamd Ayman", "type": "user", "account_id": "557058:53a1879d-b572-46c9-97d3-8fa52b2ff8a7"}, "updated_on": "2017-10-31T01:04:45.287334+00:00", "type": "pullrequest_comment", "id": 48376731}